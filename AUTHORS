original code: Jan Hajic <hajic@ufal.mff.cuni.cz>
x86_64 port + library code: Miroslav Spousta <qiq@ucw.cz>
